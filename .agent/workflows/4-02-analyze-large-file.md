---
description: 系统化分析大文件工作流
---

# 大文件分析工作流

## 使用场景
需要详细分析一个大文件（>300行）时，确保 AI 完整阅读所有内容，而不只关注前面部分

---

## ⚠️ 问题说明

**AI 的局限性**:
- 一次性查看大文件时，可能重点关注前面内容
- 文件越大，后面部分被忽略的可能性越高
- 需要系统化的分段阅读策略

---

## 📋 标准流程

### Step 1: 确定文件范围

**命令**:
```
请分析 @[文件路径]
注意：这是一个大文件，请使用系统化分析流程
```

**AI 会先查看**:
```bash
# 获取文件行数
(Get-Content "文件路径" | Measure-Object -Line).Lines
```

---

### Step 2: 制定分析计划

**AI 会根据文件大小制定计划**:

| 文件大小 | 分段策略 | 每段行数 |
|---------|---------|---------|
| 300-600 行 | 3 段 | ~200 行/段 |
| 600-1000 行 | 4-5 段 | ~200 行/段 |
| 1000+ 行 | 5+ 段 | ~200 行/段 |

**计划示例**（800 行文件）:
```
分段计划：
- 第 1 段：1-200 行（头部定义和配置）
- 第 2 段：201-400 行（核心功能实现）
- 第 3 段：401-600 行（工具函数）
- 第 4 段：601-800 行（导出和尾部）
```

---

### Step 3: 逐段深度分析

**每段分析包含**:

1. **代码内容** - 查看该段代码
2. **功能识别** - 该段主要功能
3. **关键发现** - 重要代码/问题
4. **待关注** - 需要在其他段验证的内容

**分析模板**:
```markdown
## 第 X 段分析 (行 XXX-XXX)

### 主要内容
- [功能1]
- [功能2]

### 关键发现
- ⭐ [重要发现1]
- ⚠️ [潜在问题]

### 待验证
- [ ] [需要在其他段确认的内容]
```

---

### Step 4: 交叉验证

**重点关注**:
- 前后段的关联关系
- 变量/函数的定义和使用
- 数据流的完整性

**验证清单**:
- [ ] 所有导入的依赖都有使用吗？
- [ ] 所有定义的函数都有调用吗？
- [ ] 数据流是否完整（定义→使用→保存）？
- [ ] 是否有 Dead Code？

---

### Step 5: 综合总结

**输出格式**:
```markdown
# [文件名] 完整分析报告

## 📊 文件概览
- 总行数：XXX 行
- 主要功能：[概述]
- 代码质量：⭐⭐⭐⭐

## 🏗️ 结构分析
### 1. 头部 (1-200行)
[功能说明]

### 2. 核心逻辑 (201-600行)
[功能说明]

### 3. 工具函数 (601-800行)
[功能说明]

## ⭐ 关键发现
1. [发现1]
2. [发现2]

## ⚠️ 潜在问题
1. [问题1]
2. [问题2]

## ✅ 优点
1. [优点1]
2. [优点2]

## 📝 改进建议
1. [建议1]
2. [建议2]
```

---

## 💡 使用示例

### 示例 1: 分析一个 600 行的 Composable

**你说**:
```
请系统化分析 @[word-pet/pages/index/composables/useSkins.js]
注意这是一个 500+ 行的大文件
```

**AI 的分析计划**:
```
文件行数：509 行

分段计划：
1. 第 1 段（1-150行）：导入、类型定义、状态初始化
2. 第 2 段（151-300行）：皮肤加载和管理逻辑
3. 第 3 段（301-450行）：皮肤应用和同步
4. 第 4 段（451-509行）：返回值和导出

开始逐段分析...
```

---

### 示例 2: 分析文档文件

**你说**:
```
请系统化分析 @[word-pet/DEVELOPMENT.md]
重点关注是否有遗漏或过时的内容
```

**AI 的分析计划**:
```
文件行数：736 行

分段计划：
1. 概览和快速开始 (1-200行)
2. 项目结构和核心模块 (201-400行)
3. 开发规范和调试 (401-600行)
4. FAQ 和附录 (601-736行)

分析重点：
- 内容完整性
- 信息准确性
- 是否有过时内容
```

---

## 🔧 进阶技巧

### 技巧 1: 指定分析重点

```
请系统化分析 @[文件]
重点关注：
- 性能问题
- 响应式陷阱
- 逻辑闭环
```

### 技巧 2: 对比分析

```
请系统化分析并对比：
@[word-pet/docs/maintenance/BUG.md]
@[word-pet/docs/maintenance/bug_prevention_guide.md]

找出是否有重复内容
```

### 技巧 3: 结构化输出

```
请系统化分析 @[文件]
并输出：
1. 思维导图（Mermaid）
2. 函数调用关系图
3. 数据流图
```

---

## 📊 分段策略参考

### 代码文件

**Composable / Service**:
```
第 1 段：导入 + 类型定义 + 状态初始化
第 2 段：数据加载和保存
第 3 段：业务逻辑方法
第 4 段：返回值和导出
```

**Vue 组件**:
```
第 1 段：<template> 部分
第 2 段：<script setup> - props/emits/状态
第 3 段：<script setup> - 方法和逻辑
第 4 段：<style> 部分
```

### 文档文件

**技术文档**:
```
第 1 段：概览和目录
第 2 段：核心内容（上半部分）
第 3 段：核心内容（下半部分）
第 4 段：附录和参考
```

---

## ⚡ 快速命令

**基础分析**:
```
/7-analyze-large-file @[文件路径]
```

**深度分析**:
```
/7-analyze-large-file @[文件路径]
重点：[性能/架构/可维护性]
```

**对比分析**:
```
/7-analyze-large-file
对比 @[文件1] 和 @[文件2]
```

---

## ✅ 检查清单

**分析前**:
- [ ] 确认文件大小（>300 行才需要分段）
- [ ] 明确分析目的（功能理解/问题排查/优化建议）

**分析中**:
- [ ] 每段都仔细阅读
- [ ] 记录跨段的关联
- [ ] 标记待验证的内容

**分析后**:
- [ ] 完整性检查（是否遗漏重要部分）
- [ ] 交叉验证（前后段关联是否理解正确）
- [ ] 输出综合报告

---

## 📖 参考

- [DEVELOPMENT.md](../../DEVELOPMENT.md) - 了解项目结构
- [bug_prevention_guide.md](../../docs/maintenance/bug_prevention_guide.md) - 常见问题模式

---

## 🎯 预期效果

**使用前**（一次性读取）:
```
AI：快速扫描文件，重点关注前 200 行
结果：后半部分理解不深，可能遗漏重要信息
```

**使用后**（系统化分析）:
```
AI：制定计划 → 逐段深读 → 交叉验证 → 综合总结
结果：全面理解文件，不遗漏任何重要内容
```

---

**创建时间**: 2025-12-06  
**适用场景**: 300+ 行的代码文件或文档
