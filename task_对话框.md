# WordParasite 功能扩展任务清单

## 当前阶段
- [x] 分析现有项目结构
- [x] 设计聊天对话窗口方案
- [x] 设计宠物成长系统方案
- [x] 用户审核方案并确认细节
- [x] 核心功能实施完成
- [ ] 用户测试和反馈
- [ ] 后续优化和改进

## 一、聊天对话窗口功能

### 架构设计
- [x] 设计聊天数据结构
- [x] 规划消息存储方案
- [x] 设计双向通信协议

### UI 组件开发
- [x] 创建 `ChatPanel.vue` (主聊天界面)
- [x] 创建 `ChatBubble.vue` (消息气泡组件)
- [x] 在主界面新增"对话" Tab
- [x] 实现消息列表滚动和自动定位

### 逻辑层实现  
- [x] 创建 `useChat.js` composable
  - [ ] 连续学习 30 分钟触发鼓励
  - [ ] 连续摸鱼触发警告
  - [ ] 每日首次打开问候

### 悬浮窗聊天 (可选功能 - 未实施)
- [ ] 修改 `static/pet.html` 添加输入框
- [ ] 处理软键盘遮挡问题
- [ ] 实现悬浮窗双向消息同步
- [ ] 性能优化与兼容性测试

---

## 二、宠物成长系统

### 核心数值系统
- [x] 创建 `useGrowth.js` composable
  - [x] 等级/经验值管理
  - [x] 心情值扩展逻辑
  - [x] 新增饥饿度系统
  - [x] 新增亲密度系统
  - [x] 金币系统完善
- [x] 创建 `utils/growthFormula.js`
  - [x] 升级经验公式
  - [x] 自然衰减公式
  - [x] 奖励计算公式

### 宠物形态系统
- [x] 设计 4 种宠物类型（幽灵、中华田园犬、玄凤鹦鹉、和尚鹦鹉）
- [x] 设计 6种形态状态
  - [x] 蛋形态 (Lv1-5)
  - [x] 幼年形态 (Lv6-15)
  - [x] 成年形态 (Lv16-30)
  - [x] 邪恶形态 (心情 < 20)
  - [x] 天使形态 (心情 > 80)
  - [x] 机械形态 (亲密度 100)
- [x] 使用 emoji + CSS filter 方案（临时）
- [x] 实现形态判定逻辑
- [x] 应用形态到主屏幕
- [ ] 应用形态到悬浮窗（待实现）

### 奖惩机制
- [x] 实现学习奖励逻辑
  - [x] 5/15/30/60 分钟阶梯奖励
  - [ ] 连续学习 Combo 系统（未来功能）
- [x] 实现摸鱼惩罚逻辑
  - [x] 心情衰减
  - [x] 金币扣除
  - [x] 饥饿度降低
- [x] 实现自然衰减机制
  - [x] 每小时饥饿度 -5
  - [x] 心情值回归中位值

### UI 可视化
- [x] 改造 `PetScreen.vue`
  - [x] 新增饥饿度进度条
  - [x] 新增亲密度进度条
  - [x] 经验条显示百分比
  - [x] 动态颜色映射 (心情高低)
  - [x] 宠物 emoji 动态显示
- [x] StatusBar 使用成长数据
  - [x] 显示等级
  - [x] 显示金币
- [ ] 创建升级动画效果（未来功能）
  - [ ] 震动反馈
  - [ ] 闪烁动画
  - [ ] 升级提示弹窗

### 成就系统
- [ ] 创建 `useAchievements.js` composable
- [ ] 创建 `utils/achievementList.js` 配置表
  - [ ] 学习类成就 (5+ 种)
  - [ ] 摸鱼类成就 (3+ 种)
  - [ ] 互动类成就 (3+ 种)
- [ ] 创建 `GrowthPanel.vue` (成就展示)
- [ ] 实现成就解锁逻辑
- [ ] 实现成就解锁动画

### 数据持久化
- [ ] 规划 Storage Key 结构
- [ ] 实现数据版本管理
- [ ] 编写数据迁移脚本
- [ ] 测试老用户数据兼容性

---

## 三、集成与测试

### 悬浮窗通信升级
- [ ] 新增消息类型 (Type 4/5/6)
- [ ] 扩展双向通信协议
- [ ] 测试消息传递稳定性

### 监控系统增强
- [ ] 修改 `useMonitor.js` 增加时长统计
- [ ] 每日学习时长累计
- [ ] 每日摸鱼时长累计
- [ ] 连续行为计数 (Combo)

### 完整流程测试
- [ ] 测试聊天功能完整流程
- [ ] 测试升级流程
- [ ] 测试形态切换
- [ ] 测试奖惩机制
- [ ] 测试成就解锁
- [ ] 测试数据持久化
- [ ] 测试 AI 上下文记忆

### 性能优化
- [ ] 防抖优化 UI 更新
- [ ] 批量写入存储
- [ ] AI 调用频率限制
- [ ] 内存泄漏检查

---

## 四、文档与发布

- [ ] 更新 README.md 功能说明
- [ ] 编写用户使用指南
- [ ] 记录已知问题和限制
- [ ] 准备版本发布说明
