<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live2D 网络测试</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: transparent;
            font-family: sans-serif;
            color: #00e676;
            padding: 10px;
        }

        .log {
            font-size: 10px;
            background: rgba(0, 0, 0, 0.8);
            padding: 5px;
            border-radius: 5px;
            max-height: 280px;
            overflow-y: auto;
        }

        .log div {
            margin: 2px 0;
        }

        .success {
            color: #00e676;
        }

        .error {
            color: #ff5252;
        }

        .info {
            color: #29b6f6;
        }
    </style>
</head>

<body>
    <div class="log" id="log"></div>

    <script>
        function log(msg, type = 'info') {
            const div = document.createElement('div');
            div.className = type;
            div.textContent = `[${new Date().toLocaleTimeString()}] ${msg}`;
            document.getElementById('log').appendChild(div);
            console.log(msg);
        }

        // 测试加载脚本
        async function testScript(name, url) {
            log(`正在加载: ${name}...`);
            return new Promise((resolve) => {
                const script = document.createElement('script');
                script.src = url;
                script.onload = () => {
                    log(`✓ ${name} 加载成功`, 'success');
                    resolve(true);
                };
                script.onerror = (e) => {
                    log(`✗ ${name} 加载失败: Network Error`, 'error');
                    resolve(false);
                };
                document.head.appendChild(script);
            });
        }

        async function runTests() {
            log('=== 开始网络测试 ===');

            // 测试 1: Cubism Core (Live2D 官方)
            const cubism = await testScript(
                'Cubism Core',
                'https://cubism.live2d.com/sdk-web/cubismcore/live2dcubismcore.min.js'
            );

            // 测试 2: PixiJS (unpkg)
            const pixi = await testScript(
                'PixiJS',
                'https://unpkg.com/pixi.js@6.5.10/dist/browser/pixi.min.js'
            );

            // 测试 3: pixi-live2d-display (unpkg)  
            const live2d = await testScript(
                'pixi-live2d-display',
                'https://unpkg.com/pixi-live2d-display@0.4.0/dist/cubism4.min.js'
            );

            log('=== 测试完成 ===');

            // 汇总
            if (cubism && pixi && live2d) {
                log('所有库加载成功！可以使用 Live2D', 'success');

                // 验证对象
                log(`PIXI: ${typeof PIXI}`, 'info');
                log(`Live2DCubismCore: ${typeof window.Live2DCubismCore}`, 'info');
                log(`PIXI.live2d: ${typeof PIXI?.live2d}`, 'info');
            } else {
                log('部分库加载失败，请检查网络', 'error');
                log('建议：开启科学上网或使用本地库文件', 'info');
            }
        }

        runTests();
    </script>
</body>

</html>